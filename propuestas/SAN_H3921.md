# #SAN #H3921 Adaptación de Smartsales para dpto de marketing
SAN_H3921

Los objetivos de este proyecto son:
+ Permitir al personal de marketing asociar tratos a agentes a través de campañas de marketing.

## Propuesta realizada a petición de:
Jesús

## Estructura
### ERP / Tipos de trato para campañas
Se podrá configurar cuál es el tipo de trato a usar como valor por defecto en tratos creados desde campañas.

### Webapp / Campañas / Ficha de campaña
Añadiremos a la tabla de *Tratos* los siguientes campos:
+ Id. Campaña.
+ Causa de pérdida de trato.

Crearemos una nueva tabla *Contactos por campaña*:
+ Id
+ Id. Campaña.
+ Email contacto
+ Teléfono contacto
+ Código postal contacto

Incluiremos en la campaña una sección *Tratos*, que permitirá:
+ Crear manualmente tratos asociados a la campaña
+ Importar contactos asociados a la campaña desde un fichero excel y crear automáticamente un trato.

En la segunda opción se imporará un fichero con los siguientes columnas:
+ Email
+ Teléfono
+ Código postal
+ Observaciones
+ Subfamilia de producto de interés

Si el contacto no existe, se creará con los datos de Email, teléfono y código postal indicados.

El trato contedrá una primera *Nota* que indicará la Subfamilia de interés (con el texto *Interesado en...*) y las observaciones. El resto de campos del trato importado serán:
+ Valor: 0€
+ Tipo: Campaña de venta en curso (el tipo de trato configurado descrito en ERP/Tipos de trato para campañas)
+ Agente: Agente asociado al código postal del contacto. Si no existe, se asignará al *Agente de marketing*

Cuando se crea un trato con un contacto ya existente cuyos datos de la excel no coinciden con los datos de la tabla de contactos, se creará un registro en la tabla *Contactos por campaña*.

Si el contacto del trato creado tiene un registro en *Contactos por campaña* (sus datos difieren de los datos de la tabla), se mostrará un aviso en el elemento de la lista correspondiente al trato afectado, con un botón que permitirá abrir el formulario de *Comparación de datos de contacto*.

Para la creación manual, los campos de Id. Campaña, Agente y Tipo de trato se calcularán automáticamente de igual forma a la carga automática, aunque luego podrán ser modificados.

Los datos de tratos asociados a la campaña se mostrarán en una lista con los siguientes colores:
+ Azul si el agente asociado al trato no es *Agente de marketing*
+ Verde si el agente asociado al trato es *Agente de marketing*

### Comparación de datos de contacto
El formulario mostrará los datos de las tablas de contactos y de contactos por campaña para comparar los datos del contacto importado y en la tabla de contactos.
Botones:
    + Actualizar datos del contacto: Copia los datos importados a la ficha del contacto.
    + Eliminar. Elimina el registro de importación (para usar cuando los datos "buenos" sean los de la ficha actual), y el aviso deja de mostrarse en la lista de tratos por 
campaña.

### Agente de marketing
El Agente de marketing será....

### Acceso para agente de marketing
Modificaremos el sistema de acceso de los usuarios de la webapp para que los usuarios cuyo grupo asociado sea MKT (marketing) puedan ver todos los tratos, contactos y tareas.
+ Accediendo a través de la campaña.
+ Accediendo a través del dashboard (botón *Ver todos* los tratos).

Los usuarios del grupo MKT tendrán un agente asociado en Agentes, al que se asociarán los tratos creados en un primer momento ¿o un agente MKT general?

### Pérdida de tratos
En el caso de que un trato pase a estado *Perdido*, se pedirá al usuario que especifique la causa del cambio de estado.
Las posibles causas serán:
+ No le van bien las fechas
+ No está interesado
+ Demasiado caro
+ Otro

### Visualización de tratos por Agentes
Los agentes podrán visualizar los tratos creados desde campañas de marketing a través de un nuevo botón *Tratos MKT* junto al botón *Ver todos* de la pantalla de Dashboard.

## Dinámica
Validados como *Agente de marketing*
### Vamos a la ficha de una campaña

### Creamos tratos a partir de una excel
+ Pulsamos el botón *Importar*.
    + Si hay algún error de formato del fichero, este se mostrará y el fichero no se procesará.
    + Si no hay errores:
        + Se creará un trato por fila del fichero.
        + Si el contacto no existe, se creará en la tabla de contactos.
        + Si el contacto existe pero los datos importados del contacto difieren de los de la tabla de contactos, el trato creado mostrará un aviso.
    + Para los tratos de la lista con diferencias podremos pulsar un botón *Resolver diferencias*, que nos permitirá comparar los datos importados y:
        + Modificar los datos de la tabla de contactos con los datos importados.
        + Eliminar el aviso si los datos de la tabla de contactos son los correctos.

### Crear un trato de forma manual.
El procedimiento es el mismo que cuando el trato no depende de una campaña, con las siguientes salvedades:
+ El tipo de trato es el tipo de trato configurado descrito en ERP/Tipos de trato para campañas.


## Notas de desarrollo
Campañas: Ver si la ficha ocupa toda la pantalla o usamos pestañas (para la lista de tratos)

Importaciones de excel (lectura de estructura o csv)

### Subtareas
+ Análisis 124,20€
+ Configuración tipo trato campaña y agente de marketing: €
+ Tratos por campaña, modificaciones en tablas, listado en webapp por colores, indicador datos distintos:
+ Importación de tratos excel: €
+ Tratos desde campaña manual: €
+ Diálogo de datos distintos carga/ERP: €
+ Causas de pérdida de tratos: €
+ Acceso / distinción de tratos de campañas para agentes.


## Manual
El manual constará de:
+ Descripción de configuraciones de tipo de trato para campañas y agente de marketing.
+ Descripción del proceso manual de carga de Excel en Campañas.
+ Descripción del proceso de comparación de datos importados / ERP.

## Presupuesto
### Análisis 124,20€
### Configuración tipo trato campaña y agente de marketing: 62,10€
### Tratos por campaña, modificaciones en tablas, listado en webapp por colores, indicador datos distintos: 248,40€
### Importación de tratos excel: 372,60€
### Tratos desde campaña manual: 124,20€
### Diálogo de datos distintos carga/ERP: 186,30€
### Causas de pérdida de tratos: 124,20€€
### Acceso / distinción de tratos de campañas para agentes: 62,10€
### Documentación: 62,10€