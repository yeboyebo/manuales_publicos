# #SAN #H4512 Incluir KPIs por comercial en previsiones y home de Smart Sales

Los objetivos de este proyecto son:
+ Poder añadir objetivos tipo KPI a previsiones de ventas de agentes
+ Que los agentes puedan visualizar el valor de los KPIs desde su aplicación web

## Propuesta realizada a petición de:
Jesús

## Estructura

### Previsiones de venta / KPI Nuevos clientes por familia / subfamilia
Añadiremos a la pantalla una pestaña que controlará los siguientes datos:

+ Familia
+ Subfamilia (no requerido)
+ Cantidad objetivo
+ Cantidad alcanzada

Incluiremos un botón para refrescar el los valores de los KPIs

El cálculo se realizará sobre clientes de facturas para el agente seleccionado en el período de la previsión que no hayan pedido anteriormente ningún artículo de la familia / subfamilia indicada.

### Previsiones de venta / KPI Cantidad de unidades a vender
Añadiremos a la pantalla una pestaña que controlará los siguientes datos:

+ Referencia
+ Descripción
+ Cantidad objetivo
+ Cantidad alcanzada

Incluiremos un botón para refrescar el los valores de los KPIs

El cálculo se realizará sobre cantidades de artículos en facturas para el agente seleccionado en el período de la previsión para la referencia indicada.

### Previsiones de venta / Copia
Modificaremos el proceso de copia para incluir en él los datos de objetivos por familia / subfamilia y de unidades vendidas 

### Smart Sales / Home
Añadiremos a la pestaña de seguimiento de ventas (parte superior de la home de Smart Sales) unos controles para mostrar el progreso con los nuevos KPIs.

Los controles serán:
+ KPI Nuevos clientes por familia
    + Etiqueta Nuevos clientes (A / B / C), donde:
        + A es el total de familias en las que los nuevos clientes alcanzados están por debajo del 50% del objetivo (color rojo)
        + B es el total de familias en las que los nuevos clientes alcanzados están entre el 50% y el 100% del objetivo (color naranja)
        + C es el total de familias en las que los nuevos clientes alcanzados están por encima del 100% del objetivo (color verde)

    + Botón Desplegar. Abre un listado con los siguientes datos para cada familia asociada al KPI para el agente:
        + Código y nombre de la familia / subfamilia (x / X) donde:
            + x Es el número de clientes alcanzado
            + X Es el número de clientes objetivo.
        + El color de cada línea es el correspondiente a la lógica anterior.

+ KPI Unidades por artículo
    + Etiqueta Unidades por producto (A / B / C), donde:
        + A es el total de productos en los que las unidades alcanzadas están por debajo del 50% del objetivo (color rojo)
        + B es el total de productos en los que las unidades alcanzadas  están entre el 50% y el 100% del objetivo (color naranja)
        + C es el total de productos en los que las unidades alcanzadas  están por encima del 100% del objetivo (color verde)

    + Botón Desplegar. Abre un listado con los siguientes datos para cada producto asociada al KPI para el agente:
        + Referencia y nombre del producto (x / X) donde:
            + x Es el total de productos alcanzado
            + X Es el total de productos objetivo.
        + El color de cada línea es el correspondiente a la lógica anterior.


## Notas de desarrollo
Opciones para cálculo semi síncrono:

+ Eventos de aprobación de pedido o modificación de líneas conectados con recálculos 
+ Recálculo periódico (Ver implementación con colas)


## Tareas
* #SAN #H4512. Previsiones de venta / KPI Nuevos clientes por familia / subfamilia
* #SAN #H4512. Previsiones de venta / KPI Cantidad de unidades a vender
* #SAN #H4512. Previsiones de venta / Copia
* #SAN #H4512. Smart Sales / Home

## Tests
+ Agente sin datos
+ Agente con 1 solo KPI
+ Agente con 2 solo KPI
+ Actualización de datos periódica / por eventos

## Manual
El manual:

+ Indicará los cambios realizados en los KPIs de la pantalla de previsiones
+ Explicará el significado de los datos mostrados en la home de Smart Sales

## Asistencia a puesta en marcha
No es necesaria.
