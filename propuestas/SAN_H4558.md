# #SAN #H4558 Ampliaciones en KPIs para independizar de previsiones de venta y añadir criterios

Los objetivos de este proyecto son:

- Independizar las previsiones de KPI de las previsiones actuales para usar distintos períodos
- Añadir criterios a los KPIs

## Propuesta realizada a petición de:

Jesús

## Estructura

### KPI por agente. Nueva tabla/master

Añadiremos una nueva tabla _sh_kpiporagente_ con los campos _id_, _codagente_, _fecha inicio_ y _fecha fin_.

Para esta tabla crearemos un formulario de master parecido al de _previsiones por agente_ y pasaremos la funcionalidad actual de KPIs de esta a la nueva.

### Previsiones de venta. Modificaciones en KPIs de App

Al conectar, se buscará la previsión de tipo KPI activa para el agente conectado, y se mostrará su período. Ejemplo:

    01-01-2016 - 31-12-2016

Se usará este período para calcular los colores de progreso. El proceso de color cálculo será:

- Se obtendrá la cantidad que teóricamente debería haberse alcanzado según los días de intervalo transcurridos / total de días de intervalo.
- En base a esa cantidad, los colores serán los mismos que hasta ahora:
  - rojo para < 50%
  - amarillo para >= 50% < 100%
  - verde para >= 100%

### Previsiones de venta. Modificaciones en KPIs de ERP. Venta de artículos

Se permitirá incluir una lista de artículos en el mismo KPI. El KPI tendrá un nombre que el usuario debe indicar para referirse al grupo de artículos (antes se usaba la descripción del artículo único del KPI)

### Previsiones de venta. Modificaciones en KPIs de ERP. Clientes nuevos

Se incluirá un campo Importe mínimo en estos KPIs para considerar clientes nuevos únicamente a los que hayan facturado por encima del valor de importe mínimo

## Notas de desarrollo

No hay notas de desarrollo

## Tareas

- #SAN #H4558. Previsiones de venta. Distinción de tipos
- #SAN #H4558. Previsiones de venta. Modificaciones en KPIs de App
- #SAN #H4558. Previsiones de venta. Modificaciones en KPIs de ERP. Venta de artículos
- #SAN #H4558. Previsiones de venta. Modificaciones en KPIs de ERP. Clientes nuevos

## Tests

- Distinción de tramos de previsión por tipo y control de solapamientos.
- Casos de varios productos en KPI de artículos
- Caso de valor mínimo no informado en KPI de nuevos clientes (se toma 0 como mínimo)
- Caso de valor mínimo informado en KPI de nuevos clientes
- APP. Caso de no existir previsión de KPIs para la fecha actual
- APP. Caso de no existir KPI para la fecha actual

## Manual

No es necesario manual

## Asistencia a puesta en marcha

No es necesaria.
